<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>class Gitview - RDoc Documentation</title>

<link href="./fonts.css" rel="stylesheet">
<link href="./rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "./";
</script>

<script src="./js/jquery.js"></script>
<script src="./js/navigation.js"></script>
<script src="./js/search_index.js"></script>
<script src="./js/search.js"></script>
<script src="./js/searcher.js"></script>
<script src="./js/darkfish.js"></script>


<body id="top" role="document" class="class">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="./index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="./table_of_contents.html#pages">Pages</a>
    <a href="./table_of_contents.html#classes">Classes</a>
    <a href="./table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    <div id="parent-class-section" class="nav-section">
  <h3>Parent</h3>

  
  <p class="link">Object
  
</div>

    <div id="includes-section" class="nav-section">
  <h3>Included Modules</h3>

  <ul class="link-list">
  
  
    <li><span class="include">Enumerable</span>
  
  
  </ul>
</div>

    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-i-git_version">#git_version</a>
    
    <li ><a href="#method-i-repo_branches">#repo_branches</a>
    
    <li ><a href="#method-i-repo_commits">#repo_commits</a>
    
    <li ><a href="#method-i-repo_committers">#repo_committers</a>
    
    <li ><a href="#method-i-repo_email">#repo_email</a>
    
    <li ><a href="#method-i-repo_exists-3F">#repo_exists?</a>
    
    <li ><a href="#method-i-repo_files">#repo_files</a>
    
    <li ><a href="#method-i-repo_firstcommit">#repo_firstcommit</a>
    
    <li ><a href="#method-i-repo_lastcommit">#repo_lastcommit</a>
    
    <li ><a href="#method-i-repo_leastchanged">#repo_leastchanged</a>
    
    <li ><a href="#method-i-repo_mostchanged">#repo_mostchanged</a>
    
    <li ><a href="#method-i-repo_name">#repo_name</a>
    
    <li ><a href="#method-i-repo_remotes">#repo_remotes</a>
    
    <li ><a href="#method-i-repo_status">#repo_status</a>
    
    <li ><a href="#method-i-repo_user">#repo_user</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="class-Gitview">
  <h1 id="class-Gitview" class="class">
    class Gitview
  </h1>

  <section class="description">
    
<p>This class is used to gather git repo information using backticks or
system(). None of the methods expects parameters to be passed into them.
Future versions will take arguments for more extensible operation.</p>

  </section>

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    

    
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

    
      <div id="method-i-git_version" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">git_version</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Get the version of git</p>
          
          

          
          <div class="method-source-code" id="git_version-source">
            <pre><span class="ruby-comment"># File lib/gitview.rb, line 44</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">git_version</span>
  <span class="ruby-ivar">@git_version</span> = <span class="ruby-value">%xgit --version`</span>.<span class="ruby-identifier">chomp</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-repo_branches" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">repo_branches</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Count branches of the repository.</p>
          
          

          
          <div class="method-source-code" id="repo_branches-source">
            <pre><span class="ruby-comment"># File lib/gitview.rb, line 106</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">repo_branches</span>
  <span class="ruby-identifier">branches</span> = <span class="ruby-value">%xgit branch`</span>.<span class="ruby-identifier">split</span>(<span class="ruby-regexp">/\n/</span>)
  <span class="ruby-ivar">@repo_branches</span> = <span class="ruby-identifier">branches</span>.<span class="ruby-identifier">select</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">b</span><span class="ruby-operator">|</span> <span class="ruby-identifier">b</span> <span class="ruby-operator">!~</span> <span class="ruby-regexp">/master.*/</span> }
  <span class="ruby-ivar">@repo_branches</span>.<span class="ruby-identifier">count</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-repo_commits" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">repo_commits</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Count total commits in the master branch excluding merges.</p>
          
          

          
          <div class="method-source-code" id="repo_commits-source">
            <pre><span class="ruby-comment"># File lib/gitview.rb, line 115</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">repo_commits</span>
  <span class="ruby-identifier">@@repo_commits</span> = <span class="ruby-value">%xgit log master --no-merges --reverse --format=&quot;%ai&quot;`</span>.<span class="ruby-identifier">split</span>(<span class="ruby-regexp">/\n/</span>)
  <span class="ruby-identifier">@@repo_commits</span>.<span class="ruby-identifier">count</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-repo_committers" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">repo_committers</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Use output of git shortlog -sn and truncate to array with first 3 lines to
create a list of the 3 most active committers to the repository.</p>
          
          

          
          <div class="method-source-code" id="repo_committers-source">
            <pre><span class="ruby-comment"># File lib/gitview.rb, line 163</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">repo_committers</span>
  <span class="ruby-identifier">committers</span> = <span class="ruby-value">%xgit shortlog -sn`</span>.<span class="ruby-identifier">split</span>(<span class="ruby-regexp">/\n/</span>)
  <span class="ruby-ivar">@repo_committers</span> = <span class="ruby-identifier">committers</span>.<span class="ruby-identifier">values_at</span>(<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">2</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-repo_email" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">repo_email</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Determine repo user email. If unset locally and globally, “unset@unset” is
reported.</p>
          
          

          
          <div class="method-source-code" id="repo_email-source">
            <pre><span class="ruby-comment"># File lib/gitview.rb, line 78</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">repo_email</span>
  <span class="ruby-identifier">local_email</span> = <span class="ruby-value">%xgit config --local user.email`</span>
  <span class="ruby-identifier">global_email</span> = <span class="ruby-value">%xgit config --global user.email`</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">local_email</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;&quot;</span>
    <span class="ruby-ivar">@repo_email</span> = <span class="ruby-identifier">global_email</span>
    <span class="ruby-ivar">@repo_email</span> = <span class="ruby-string">&quot;unset@unset&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">global_email</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;&quot;</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@repo_email</span> = <span class="ruby-identifier">local_email</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-repo_exists-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">repo_exists?</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Checks to see if a repo exists in the current working directory. If one is
not found, the program is aborted.</p>
          
          

          
          <div class="method-source-code" id="repo_exists-3F-source">
            <pre><span class="ruby-comment"># File lib/gitview.rb, line 17</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">repo_exists?</span>
  <span class="ruby-identifier">direxists</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">directory?</span>(<span class="ruby-string">&quot;./.git&quot;</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">direxists</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">false</span>
    <span class="ruby-identifier">abort</span> <span class="ruby-string">&quot;No repo found in current working directory!\n\n&quot;</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">cfgexists</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-string">&quot;./.git/config&quot;</span>)
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">cfgexists</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">false</span>
      <span class="ruby-identifier">abort</span> <span class="ruby-string">&quot;No repo config found!\n\n&quot;</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-ivar">@repo_exists</span> = <span class="ruby-keyword">true</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-repo_files" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">repo_files</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Count files in the repository.</p>
          
          

          
          <div class="method-source-code" id="repo_files-source">
            <pre><span class="ruby-comment"># File lib/gitview.rb, line 92</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">repo_files</span>
  <span class="ruby-ivar">@repo_files</span> = <span class="ruby-value">%xgit ls-files`</span>.<span class="ruby-identifier">split</span>(<span class="ruby-regexp">/\n/</span>).<span class="ruby-identifier">length</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-repo_firstcommit" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">repo_firstcommit</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Identify first commit in the repository.</p>
          
          

          
          <div class="method-source-code" id="repo_firstcommit-source">
            <pre><span class="ruby-comment"># File lib/gitview.rb, line 123</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">repo_firstcommit</span>
  <span class="ruby-comment"># let&#39;s reuse the class variable @@repo_commits</span>
  <span class="ruby-identifier">@@repo_commits</span>.<span class="ruby-identifier">first</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-repo_lastcommit" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">repo_lastcommit</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Identify most recent commit in the repository.</p>
          
          

          
          <div class="method-source-code" id="repo_lastcommit-source">
            <pre><span class="ruby-comment"># File lib/gitview.rb, line 131</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">repo_lastcommit</span>
  <span class="ruby-comment"># let&#39;s reuse the class variable @@repo_commits</span>
  <span class="ruby-identifier">@@repo_commits</span>.<span class="ruby-identifier">last</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-repo_leastchanged" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">repo_leastchanged</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Identify least changed files in the repository, using the class array
@@allchanged created by <a
href="Gitview.html#method-i-repo_mostchanged">#repo_mostchanged</a>()</p>
          
          

          
          <div class="method-source-code" id="repo_leastchanged-source">
            <pre><span class="ruby-comment"># File lib/gitview.rb, line 153</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">repo_leastchanged</span>
  <span class="ruby-comment"># let&#39;s reuse our deduped array from repo_mostchanged()</span>
  <span class="ruby-identifier">lc</span> = <span class="ruby-identifier">@@allchanged</span>.<span class="ruby-identifier">first</span>(<span class="ruby-value">3</span>).<span class="ruby-identifier">reverse</span>
  <span class="ruby-ivar">@repo_leastchanged</span> = <span class="ruby-constant">Hash</span>[<span class="ruby-operator">*</span><span class="ruby-identifier">lc</span>.<span class="ruby-identifier">flatten</span>]
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-repo_mostchanged" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">repo_mostchanged</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Identify most changed files in the repository</p>
          
          

          
          <div class="method-source-code" id="repo_mostchanged-source">
            <pre><span class="ruby-comment"># File lib/gitview.rb, line 139</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">repo_mostchanged</span>
  <span class="ruby-identifier">changes</span> = <span class="ruby-value">%xgit log master --pretty=format: --name-only`</span>.<span class="ruby-identifier">split</span>(<span class="ruby-regexp">/\n/</span>)
  <span class="ruby-identifier">mostchanged</span> = <span class="ruby-identifier">changes</span>.<span class="ruby-identifier">select</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/[[:alpha:]]/</span> }
  <span class="ruby-identifier">deduped</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span> <span class="ruby-value">0</span>
  <span class="ruby-identifier">mostchanged</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">deduped</span>.<span class="ruby-identifier">store</span>(<span class="ruby-identifier">v</span>,<span class="ruby-identifier">deduped</span>[<span class="ruby-identifier">v</span>]<span class="ruby-operator">+</span><span class="ruby-value">1</span>) }
  <span class="ruby-identifier">@@allchanged</span> = <span class="ruby-identifier">deduped</span>.<span class="ruby-identifier">sort_by</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">v</span> }
  <span class="ruby-identifier">mc</span> = <span class="ruby-identifier">@@allchanged</span>.<span class="ruby-identifier">last</span>(<span class="ruby-value">3</span>).<span class="ruby-identifier">reverse</span>
  <span class="ruby-ivar">@repo_mostchanged</span> = <span class="ruby-constant">Hash</span>[<span class="ruby-operator">*</span><span class="ruby-identifier">mc</span>.<span class="ruby-identifier">flatten</span>]
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-repo_name" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">repo_name</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Use the name of the current working directory as the name of the git
repository.</p>
          
          

          
          <div class="method-source-code" id="repo_name-source">
            <pre><span class="ruby-comment"># File lib/gitview.rb, line 35</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">repo_name</span>
  <span class="ruby-ivar">@repo_name</span> = <span class="ruby-value">%xgit rev-parse --show-toplevel`</span>.<span class="ruby-identifier">chomp</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">&quot;/&quot;</span>).<span class="ruby-identifier">last</span>
  <span class="ruby-ivar">@repo_name</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-node">&quot;#{@repo_name}&quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-repo_remotes" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">repo_remotes</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Gather list of non-local copies of the repository.</p>
          
          

          
          <div class="method-source-code" id="repo_remotes-source">
            <pre><span class="ruby-comment"># File lib/gitview.rb, line 99</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">repo_remotes</span>
  <span class="ruby-ivar">@repo_remotes</span> = <span class="ruby-value">%xgit remote -v`</span>.<span class="ruby-identifier">split</span>(<span class="ruby-regexp">/\n/</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-repo_status" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">repo_status</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Check the repo to see if it is current or not</p>
          
          

          
          <div class="method-source-code" id="repo_status-source">
            <pre><span class="ruby-comment"># File lib/gitview.rb, line 51</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">repo_status</span>
  <span class="ruby-identifier">status</span> = <span class="ruby-identifier">system</span>(<span class="ruby-string">&quot;git status --porcelain -z&quot;</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">status</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;&quot;</span>
    <span class="ruby-ivar">@repo_status</span> = <span class="ruby-string">&quot;Not current!&quot;</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@repo_status</span> = <span class="ruby-string">&quot;Current&quot;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-repo_user" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">repo_user</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Determine repo user name. If unset locally and globally, “unset” is
reported.</p>
          
          

          
          <div class="method-source-code" id="repo_user-source">
            <pre><span class="ruby-comment"># File lib/gitview.rb, line 63</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">repo_user</span>
  <span class="ruby-identifier">local_user</span> = <span class="ruby-value">%xgit config --local user.name`</span>
  <span class="ruby-identifier">global_user</span> = <span class="ruby-value">%xgit config --global user.name`</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">local_user</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;&quot;</span>
    <span class="ruby-ivar">@repo_user</span> = <span class="ruby-identifier">global_user</span>
    <span class="ruby-ivar">@repo_user</span> = <span class="ruby-string">&quot;unset&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">global_user</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;&quot;</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@repo_user</span> = <span class="ruby-identifier">local_user</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="http://rdoc.rubyforge.org">RDoc</a> 4.1.2.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

